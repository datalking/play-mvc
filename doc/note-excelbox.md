# note-excelbox

## dev faq

- excelbox的目标是解决什么问题，特色功能有哪些
    - 目标提供是excel一站式操作的工具箱
    - 特色
        - 图表处理

- 读取解析excel时的输入流/输入文件、解析参数如何设置？
    - jackson-core通过Feature枚举类
    - easyexcel通过Sheet对象
    - excel4j直接通过方法参数
    - excelbox 采用的是Feature枚举类设置通用参数，SheetInfo对象设置具体表的参数
    
- 读取解析时的可选参数有哪些
    - sheet数据对应的bean模型类 beanClazz，默认null
    - 表头行数 headerLineNum，默认0，表示无表头
    - 要读取的sheet索引号 sheetIndex，默认1
        - 或者 sheetName，在sheet索引号不确定的情况下，暂不支持
    - 要读取数据的范围，cellRangeBox，默认null
    
- 默认以无模型映射的方式读取时，空白单元格如何处理？
    - empty/blank/null的单元格，打印时都输出空字符串""
    
- 空单元格的处理策略
    - 读完数据后会遍历所有行所有列，找出最大列数，根据最大列数将其它行的左侧补空字符串
    - null默认当作空字符串处理



- 备注
    - 读取和解析excel有些参数是共享的
    - excel4j的接口设计
        - 读excel有映射
        - 读excel无映射
        - 写excel有映射、有模板、list data
        - 写excel有映射、有模板、map data
        - 写excel有映射、无模板
        - 写excel无映射、无模板
        - 读csv有映射
        - 写csv有映射
        

## todo

-[x] 读excel时，列空值(empty/blank)或无值(null)会作为空单元格处理，空单元格都会读取为空字符串  
-[ ] 多级表头的名称支持动态设置与修改
-[ ] 日期类型数据处理

-[ ] readExcelAsListOfString()未计算公式
-[ ] 多级表头的表达方式切换为 h1.h2.h3=子列名

## later 

-[ ] 读excel时，默认无表头，支持多行表头，换句话说，支持嵌套的列
-[ ] 测试复杂excel文件： 合并单元格
-[ ] 支持表头行上面存在标题行

## remind

-[ ] 参考excel4j，支持基于excel模板和map导出excel文件
-[ ] each worksheet in the workbook can be generated by a different thread
-[ ] 使用mac系统1904格式的日期  
-[ ] 读取时基于模型类创建java对象，使用反射性能不高

## jackson, core, csv

## limitations

- 默认只读取第一张sheet
- 多级表头/复合表头的支持
    - 读取时只支持单级表头，读取时只支持表头只占1行，且表头单元格未合并
    - 生成时支持多级表头
- 读取excel生成java对象列表时，java对象属性不支持模型类，支持基本类型

## usage

- 通过传入clazz将sheet生成java对象列表，clazz属性决定字段名，order注解决定顺序
    - 生成时需要order，默认按属性书写顺序
    - 读取时先按order，无order则按属性名与表头第一行的对应关系
    - 目前模型类必须使用注解, **暂不支持** 不使用注解而根据属性名和表头行列名推断

- java开发常用步骤
    - 读取注解配置信息
    - 根据注解配置创建对象